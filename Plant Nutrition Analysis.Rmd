---
title: "Plant Nutrition Analysis"
author: "Meghan Manhatton"
date: "2023-04-07"
output: 
  prettydoc::html_pretty:
    theme: leonids
    highlight: github
---



```{r "setup", echo=FALSE, error=TRUE, include=FALSE}

# install.packages("prettydoc")
# install.packages("report")
# install.packages("ggpubr")
# install.packages("car")
library(here)
library(readxl)
library(ggplot2)
library(tidyverse)
library(car)
library(ggpubr)
library(gridExtra)
library("easystats")
library("report")


data <- read_xlsx(
  here( "","Data.xlsx")
)

dat <- data %>%  
  replace(is.na(.), 0) %>%
  mutate(wetroottoshoot = RootWetWeight / ShootWetWeight) %>%
  mutate(dryroottoshoot = RootDryWeight / ShootDryWeight)

spp <- unique(dat$Species)


```

## These tabs contain the initial data analysis results: {.tabset}

### Is the root:shoot data normal? And ANOVA report

```{r, echo=FALSE}

##Is the data normal?

fun_shapiro <- for(i in 1:length(spp)){
  
  sp <- assign(paste0("",i), spp[[i]])
  
  res_aov <- filter(dat, Species == sp) 
     
  res_aov1 <- (aov(dryroottoshoot ~ Rate,
               data = res_aov))

  par(mfrow = c(1,2))

  hist(res_aov1$residuals,
       ylab = "residuals",
       main = paste0(sp," residuals"))

  qqPlot(res_aov1$residuals,
           id = FALSE
          )

  print(paste0(sp, ":"))
  cat("Sample Size: " , nrow(res_aov), "\n") 
  print(report(res_aov1))
} 

```

### Root:Shoot Correlations {.tabset}

```{r, echo=FALSE}

corrbase <- ggplot(dat, aes(x=`RootDryWeight`, y= `ShootDryWeight`, color=Rate)) +
      geom_point(size = 0.5) +
      geom_smooth(method="lm", fill= NA)+
      xlab("Root Dry Weight") +
      ylab("Shoot Dry Weight") +
      ggtitle("Root to Shoot Correlation Graphs")

corrbase + facet_wrap(~Species, ncol = 2)


```

###

```{r, echo=FALSE}

fun_box <- for(i in 1:length(spp)){
  
  sp <- assign(paste0("",i), spp[[i]])
  
  boxdat <- filter(dat, Species == sp) 
  
boxbase <- ggplot(boxdat, aes(y = dryroottoshoot, x= Rate, fill = Rate))+
  geom_boxplot() +
  #xlab(paste0("",i)) +
  ylab('Root to Shoot Ratio') +
  ggtitle(paste0(sp)) +
  scale_fill_discrete(name = "Osmocote Rates")+
  geom_jitter(aes(col = Rate), size= 1.5, alpha=0.9, width = 0.2) #+
  #scale_x_discrete(breaks = c('Asclepiastuberosa', 'Lespedeza'),
  #                 labels = c("ASTU", "LECA"))

print(boxbase)


}


boxbase <- ggplot(dat, aes(y = dryroottoshoot, x= Rate, fill = Rate))+
  geom_boxplot() +
  ylab('Root to Shoot Ratio') +
  ggtitle("Root to Shoot Ratios") +
  scale_fill_discrete(name = "Osmocote Rates")#+
  #geom_jitter(aes(col = Rate), size= 1.5, alpha=0.9, width = 0.2) #+
  #scale_x_discrete(breaks = c('Asclepiastuberosa', 'Lespedeza'),
  #                 labels = c("ASTU", "LECA"))

boxbase + facet_wrap(~Species, ncol = 2)

```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
